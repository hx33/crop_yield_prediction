fxreg = cbind(Yield=fyield$mean, Food=ffood$mean)
fcast = forecast(fit, xreg=xreg)
autoplot(fcast)+xlab("Time")+ylab("Price")
fit_yield = Arima(tsdf$Yield, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
fyield = forecast(fit_yield, h=12)
fit_food = Arima(tsdf$Food_Use, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
ffood = forecast(fit_food, h=12)
fxreg = cbind(Yield=fyield$mean, Food=ffood$mean)
fcast = forecast(fit, xreg=xreg)
autoplot(fcast)+xlab("Time")+ylab("Price")
fit_yield = Arima(tsdf$Yield, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
fyield = forecast(fit_yield, h=4)
fit_food = Arima(tsdf$Food_Use, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
ffood = forecast(fit_food, h=4)
fxreg = cbind(Yield=fyield$mean, Food=ffood$mean)
fcast = forecast(fit, xreg=xreg)
autoplot(fcast)+xlab("Time")+ylab("Price")
fit_yield = Arima(tsdf$Yield, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
fyield = forecast(fit_yield, h=4)
fit_food = Arima(tsdf$Food_Use, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
ffood = forecast(fit_food, h=4)
fxreg = cbind(Yield=fyield$mean, Food=ffood$mean)
fcast = forecast(fit, xreg=fxreg)
autoplot(fcast)+xlab("Time")+ylab("Price")
fit_yield = Arima(tsdf$Yield, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
fyield = forecast(fit_yield, h=24)
fit_food = Arima(tsdf$Food_Use, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
ffood = forecast(fit_food, h=24)
fxreg = cbind(Yield=fyield$mean, Food=ffood$mean)
fcast = forecast(fit, xreg=fxreg)
autoplot(fcast)+xlab("Time")+ylab("Price")
fit_yield = auto.arima(tsdf$Yield)
fyield = forecast(fit_yield, h=24)
fit_food = auto.arima(tsdf$Food_Use)
ffood = forecast(fit_food, h=24)
fxreg = cbind(Yield=fyield$mean, Food=ffood$mean)
fcast = forecast(fit, xreg=fxreg)
autoplot(fcast)+xlab("Time")+ylab("Price")
fit_yield = Arima(tsdf$Yield, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
fyield = forecast(fit_yield, h=24)
fit_food = Arima(tsdf$Food_Use, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
ffood = forecast(fit_food, h=24)
fxreg = cbind(Yield=fyield$mean, Food=ffood$mean)
fcast = forecast(fit, xreg=fxreg)
autoplot(fcast)+xlab("Time")+ylab("Price")
xreg = cbind(yield = tsdf[,"Yield"],
food = tsdf[,"Food_Use"])
fit = Arima(tsdf[,"Price"], order=c(1,1,0), seasonal=c(0,1,1), xreg=xreg)
summary(fit)
fit_yield = Arima(tsdf$Yield, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
fyield = forecast(fit_yield, h=24)
fit_food = Arima(tsdf$Food_Use, order=c(1,1,0), seasonal=list(order=c(0,1,1),period=12))
ffood = forecast(fit_food, h=24)
fxreg = cbind(Yield=fyield$mean, Food=ffood$mean)
fcast = forecast(fit, xreg=fxreg)
autoplot(fcast)+xlab("Time")+ylab("Price")
library(tidyverse)
library(forecast)
library(astsa)
library(xts)
library(tseries)
library(fpp2)
library(fma)
library(lubridate)
library(TSstudio)
library(quantmod)
library(tidyquant)
library(plotly)
library(ggplot2)
library(gridExtra)}
library(tidyverse)
library(forecast)
library(astsa)
library(xts)
library(tseries)
library(fpp2)
library(fma)
library(lubridate)
library(TSstudio)
library(quantmod)
library(tidyquant)
library(plotly)
library(ggplot2)
library(gridExtra)
wheat = read.csv("./HW4/USA_Wheat.csv")
View(wheat)
str(wheat)
start_date = c(2002, 8)
price_ts = ts(wheat$Price, start=start_date, frequency=12)
autoplot(price_ts)+xlab("Time")+ylab("Price")
wheat = read.csv("./HW4/USA_Wheat.csv")
wheat = wheat[,c(1,3,4,5,6,7)]
wheat$Yield = na.approx(wheat$Yield)
wheat$Food_Use = as.numeric(gsub(",", "", wheat$Food_Use))
wheat$Import = as.numeric(gsub(",", "", wheat$Import))
wheat$Export = as.numeric(gsub(",", "", wheat$Export))
start_date = c(2002, 8)
price_ts = ts(wheat$Import, start=start_date, frequency=12)
autoplot(price_ts)+xlab("Time")+ylab("Price")
start_date = c(2002, 8)
price_ts = ts(wheat$Export, start=start_date, frequency=12)
autoplot(price_ts)+xlab("Time")+ylab("Price")
start_date = c(2002, 8)
price_ts = ts(wheat$Price, start=start_date, frequency=12)
autoplot(price_ts)+xlab("Time")+ylab("Price")
getSymbols("BG", from="2012-01-01", src="yahoo")
View(BG)
getSymbols("BG", from="2012-01-01", src="yahoo")
returns = ts(BG$BG.Adjusted, freq=1)
autoplot(returns)
getSymbols("BG", from="2012-01-01", src="yahoo")
returns = ts(BG$BG.Adjusted, freq=1)
chartSeries(returns, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
chartSeries(BG, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
Ad(BG)
Ad(BG)[1]
View(BG)
getSymbols("BG", from="2012-01-01", src="yahoo")
returns = ts(BG$BG.Adjusted, freq=1)
returns = diff(log(returns))
chartSeries(returns, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
BG_close = Ad(BG)
returns = diff(log(BG_close)
chartSeries(returns, theme=chartTheme("white"), bar.type="hlc",
BG_close = Ad(BG)
returns = diff(log(BG_close))
chartSeries(returns, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
autoplot(ts(BG_close), freq=1)
autoplot(ts(BG_close, freq=1))
BG_close = Ad(BG)
autoplot(ts(BG_close, freq=1))+xlab("Time")+ylab("Returns")
returns = diff(log(BG_close))
chartSeries(returns, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
View(BG_close)
View(BG_close)
View(BG)
BG_close = Ad(BG)
returns = diff(log(BG_close))
chartSeries(returns, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
ggAcf(returns)
ggPacf(returns)
ggAcf(abs(returns))
ggPacf(returns)
ggAcf(abs(returns))
ggAcf(returns**2)
ggAcf(returns)
ggPacf(returns)
scores = matrix(rep(NA,4*6), nrow=6, ncol=4)
i=1
for (p in 0:5){
model = Arima(returns, order=c(p,0,0), include.drift=TRUE)
scores[i,] = c(p, model$aic, model$bic, model$aicc)
i = i+1
}
scores = as.data.frame(scores)
colnames(scores) = c("p","AIC","BIC","AICc")
scores
View(scores)
ar1 = arima(returns, order=c(1,0,0))
arch_list = list()
i=1
for (p in 1:10){
arch_list[[i]] = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,p), trace=F)
i = i+1
}
aic_arch = sapply(arch_list, AIC)
which(aic_arch==min(aic_arch))
arch3 = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,10), trace=F)
summary(arch3)
scores = matrix(rep(0, 6*18), nrow=18, ncol=6)
i=1
for (p in 0:2){
for (d in 0:1){
for (q in 0:2){
model = Arima(returns, order=c(p,d,q), include.drift=TRUE)
scores[i,] = c(p,q,model$aic, model$bic, model$aicc)
i = i+1
}
}
}
scores = matrix(rep(0, 6*18), nrow=18, ncol=6)
i=1
for (p in 0:2){
for (d in 0:1){
for (q in 0:2){
model = Arima(returns, order=c(p,d,q), include.drift=TRUE)
scores[i,] = c(p,d,q,model$aic, model$bic, model$aicc)
i = i+1
}
}
}
scores = as.data.frame(scores)
colnames(scores) = c("p","d", "q","AIC","BIC","AICC")
knitr::kable(scores, format="pipe", padding=30, digits=2)
View(scores)
fit100 = Arima(returns, order=c(1,0,0))
res100 = fit_100$residuals
fit100 = Arima(returns, order=c(1,0,0))
res100 = fit100$residuals
ggAcf(res100^2)
fit100 = Arima(returns, order=c(1,0,0))
res100 = fit100$residuals
ggAcf(res100^2)
ffPacf(res100^2)
fit100 = Arima(returns, order=c(1,0,0))
res100 = fit100$residuals
ggAcf(res100^2)
ggPacf(res100^2)
getSymbols("BG", from="2012-01-01", src="yahoo")
# wheat = read.csv("./HW4/USA_Wheat.csv")
# wheat = wheat[,c(1,3,4,5,6,7)]
# wheat$Yield = na.approx(wheat$Yield)
# wheat$Food_Use = as.numeric(gsub(",", "", wheat$Food_Use))
# wheat$Import = as.numeric(gsub(",", "", wheat$Import))
# wheat$Export = as.numeric(gsub(",", "", wheat$Export))
getSymbols("BG", from="2012-01-01", src="yahoo")
# wheat = read.csv("./HW4/USA_Wheat.csv")
# wheat = wheat[,c(1,3,4,5,6,7)]
# wheat$Yield = na.approx(wheat$Yield)
# wheat$Food_Use = as.numeric(gsub(",", "", wheat$Food_Use))
# wheat$Import = as.numeric(gsub(",", "", wheat$Import))
# wheat$Export = as.numeric(gsub(",", "", wheat$Export))
chartSeries(BG, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
BG_close = Ad(BG)
returns = diff(log(BG_close))
chartSeries(returns, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
ggAcf(returns)
ggPacf(returns)
ggAcf(abs(returns))
ggAcf(returns**2)
scores = matrix(rep(NA,4*6), nrow=6, ncol=4)
i=1
for (p in 0:5){
model = Arima(returns, order=c(p,0,0), include.drift=TRUE)
scores[i,] = c(p, model$aic, model$bic, model$aicc)
i = i+1
}
scores = as.data.frame(scores)
colnames(scores) = c("p","AIC","BIC","AICc")
scores
View(scores)
ar1 = arima(returns, order=c(1,0,0))
arch_list = list()
i=1
for (p in 1:10){
arch_list[[i]] = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,p), trace=F)
i = i+1
}
aic_arch = sapply(arch_list, AIC)
which(aic_arch==min(aic_arch))
arch3 = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,3), trace=F)
summary(arch3)
arch3$residuals
scores = matrix(rep(NA,4*6), nrow=6, ncol=4)
i=1
for (p in 0:5){
model = Arima(returns, order=c(p,0,0), include.drift=TRUE)
scores[i,] = c(p, model$aic, model$bic, model$aicc)
i = i+1
}
scores = as.data.frame(scores)
colnames(scores) = c("p","AIC","BIC","AICc")
scores
scores = matrix(rep(0, 6*18), nrow=18, ncol=6)
i=1
for (p in 0:2){
for (d in 0:1){
for (q in 0:2){
model = Arima(returns, order=c(p,d,q), include.drift=TRUE)
scores[i,] = c(p,d,q,model$aic, model$bic, model$aicc)
i = i+1
}
}
}
scores = as.data.frame(scores)
colnames(scores) = c("p","d", "q","AIC","BIC","AICC")
knitr::kable(scores, format="pipe", padding=30, digits=2)
View(scores)
fit100 = Arima(returns, order=c(1,0,0))
res100 = fit100$residuals
ggAcf(res100^2)
ggPacf(res100^2)
ar1 = arima(returns, order=c(1,0,0))
arch_list = list()
i=1
for (p in 1:10){
arch_list[[i]] = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,p), trace=F)
i = i+1
}
aic_arch = sapply(arch_list, AIC)
which(aic_arch==min(aic_arch))
arch3 = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,3), trace=F)
summary(arch3)
arch3 = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,3), trace=F)
summary(arch3)
print(min(aic_arch)-aic_arch[3])
arch3 = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,3), trace=F)
summary(arch3)
print(aic_arch[3])
library(tidyverse)
library(forecast)
library(astsa)
library(xts)
library(tseries)
library(fpp2)
library(fma)
library(lubridate)
library(TSstudio)
library(quantmod)
library(tidyquant)
library(plotly)
library(ggplot2)
library(gridExtra)
getSymbols("BG", from="2012-01-01", src="yahoo")
chartSeries(BG, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
BG_close = Ad(BG)
returns = diff(log(BG_close))
chartSeries(returns, theme=chartTheme("white"), bar.type="hlc",
up.col="green", dn.col="red")
ggAcf(returns)
ggPacf(returns)
ggAcf(abs(returns))
ggAcf(returns**2)
scores = matrix(rep(NA,4*6), nrow=6, ncol=4)
i=1
for (p in 0:5){
model = Arima(returns, order=c(p,0,0), include.drift=TRUE)
scores[i,] = c(p, model$aic, model$bic, model$aicc)
i = i+1
}
scores = as.data.frame(scores)
colnames(scores) = c("p","AIC","BIC","AICc")
scores
scores = matrix(rep(0, 6*18), nrow=18, ncol=6)
i=1
for (p in 0:2){
for (d in 0:1){
for (q in 0:2){
model = Arima(returns, order=c(p,d,q), include.drift=TRUE)
scores[i,] = c(p,d,q,model$aic, model$bic, model$aicc)
i = i+1
}
}
}
scores = as.data.frame(scores)
colnames(scores) = c("p","d", "q","AIC","BIC","AICC")
knitr::kable(scores, format="pipe", padding=30, digits=2)
ar1 = Arima(returns, order=c(1,0,0))
res1 = ar1$residuals
ggAcf(res1^2)
ggPacf(res1^2)
arch_list = list()
i=1
for (p in 1:10){
arch_list[[i]] = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,p), trace=F)
i = i+1
}
aic_arch = sapply(arch_list, AIC)
which(aic_arch==min(aic_arch))
arch3 = garch(ar1$res[2:(length(ar1$res)-1)], order=c(0,3), trace=F)
summary(arch3)
print(aic_arch[3])
garch11 = garchFit(formula=~garch(1,1), data=res1, trace=F)
library(tidyverse)
library(forecast)
library(astsa)
library(xts)
library(tseries)
library(fpp2)
library(fma)
library(lubridate)
library(TSstudio)
library(quantmod)
library(tidyquant)
library(plotly)
library(ggplot2)
library(gridExtra)
library(fGarch)
library(tidyverse)
library(forecast)
library(astsa)
library(xts)
library(tseries)
library(fpp2)
library(fma)
library(lubridate)
library(TSstudio)
library(quantmod)
library(tidyquant)
library(plotly)
library(ggplot2)
library(gridExtra)
library(fGarch)
garch11 = garchFit(formula=~garch(1,1), data=res1, trace=F)
garch(1,1)
res1
length(res1)
garch11 = garchFit(formula=~garch(1,1), data=res1, trace=F)
garch11 = garchFit(formula=~garch(1,1), data=ar1$res, trace=F)
garch11 = garchFit(formula=~garch(1,1), data=ar1$res[2:(length(ar1$res)-1)], trace=F)
summary(garch11)
ar1$res-res1
garch11 = garchFit(formula=~garch(1,1), data=res1[2:(length(res1)-1)], trace=F)
summary(garch11)
garch11
View(garch11)
summary(garch11)$AIC
sum1 = summary(garch11)
View(garch11)
garch11$AIC
str(garch11)
garch11$ics
summary(garch11)$ics
class(garch11)
length(res1[2:(length(res1)-1)])
-5.301028*2847
garch11@fit$ics
garch11 = garchFit(formula=~garch(1,1), data=res1[2:(length(res1)-1)], trace=F)
garch12 = garchFit(formula=~garch(1,2), data=res1[2:(length(res1)-1)], trace=F)
garch21 = garchFit(formula=~garch(2,1), data=res1[2:(length(res1)-1)], trace=F)
garch22 = garchFit(formula=~garch(2,2), data=res1[2:(length(res1)-1)], trace=F)
print("AIC of garch(1,1): ", garch11@fit$ics[1])
print("AIC of garch(1,1): ", as.character(garch11@fit$ics[1]))
print(paste0("AIC of garch(1,1): ", as.character(garch11@fit$ics[1])))
print(paste0("AIC of garch(1,2): ", as.character(garch12@fit$ics[1])))
print(paste0("AIC of garch(2,1): ", as.character(garch21@fit$ics[1])))
print(paste0("AIC of garch(2,2): ", as.character(garch22@fit$ics[1])))
garch11@fit$ics
garch12@fit$ics
garch11@fit$message
summary(garch11)
garch11@fit$ics
garch_models = c("garch(11)", "garch(12)", "garch(21)", "garch(22)")
garch_AIC = c(garch11@fit$ics[1],garch12@fit$ics[1],garch21@fit$ics[1], garch22@fit$ics[1])
garch_BIC = c(garch11@fit$ics[2],garch12@fit$ics[2],garch21@fit$ics[2], garch22@fit$ics[2])
garch_SIC = c(garch11@fit$ics[3],garch12@fit$ics[3],garch21@fit$ics[3], garch22@fit$ics[3])
garchs = data.frame(garch_models, garch_AIC, garch_BIC, garch_SIC)
garchs
garch_models = c("garch(11)", "garch(12)", "garch(21)", "garch(22)")
garch_AIC = c(garch11@fit$ics[1],garch12@fit$ics[1],garch21@fit$ics[1], garch22@fit$ics[1])
garch_BIC = c(garch11@fit$ics[2],garch12@fit$ics[2],garch21@fit$ics[2], garch22@fit$ics[2])
garch_SIC = c(garch11@fit$ics[3],garch12@fit$ics[3],garch21@fit$ics[3], garch22@fit$ics[3])
garchs = data.frame(garch_models, garch_AIC, garch_BIC, garch_SIC)
garchs
View(garchs)
arch3
type(arch3)
typeof(arch3)
View(arch3)
sapply(arch3, AIC)
apply(arch3, AIC)
length(garch12@data)
print(paste0("AIC of ARCH(3) = ", aic_arch[3]))
print(paste0("AIC of ARCH(3) = ", garch11@fit$ics[1]*length(garch12@data)))
summary(arch3)
summary(garch12)
summary(arch3)
summary(garch12)
library(flipbookr)
library(tidyverse)
library(ggplot2)
library(forecast)
library(astsa)
library(xts)
library(tseries)
library(fpp2)
library(fma)
library(lubridate)
library(tidyverse)
library(TSstudio)
library(quantmod)
library(tidyquant)
library(plotly)
library(ggplot2)
options("getSymbols.warning4.0"=FALSE)
options("getSymbols.yahoo.warning"=FALSE)
coms = c("GOOG","MSFT")
for (i in coms){
getSymbols(i, from = "2020-01-01", to = "2022-12-01")}
x = list(title="date")
y = list(title="value")
stock = data.frame(GOOG$GOOG.Adjusted, MSFT$MSFT.Adjusted)
stock = data.frame(stock, rownames(stock))
colnames(stock) = append(coms,'Dates')
stock$date<-as.Date(stock$Dates,"%Y-%m-%d")
stock <- stock[,-3]
head(stock)
library(tidyverse)
library(forecast)
library(astsa)
library(xts)
library(tseries)
library(fpp2)
library(fma)
library(lubridate)
library(TSstudio)
library(quantmod)
library(tidyquant)
library(plotly)
library(ggplot2)
library(gridExtra)
library(fGarch)
getSymbols("BG", from="2012-01-01", src="yahoo")
